<?xml version='1.0' encoding='utf-8'?>
<CodeGen plane="mgmt-plane">
  <resource id="/subscriptions/{}/resourcegroups/{}/providers/microsoft.operationalinsights/workspaces/{}/providers/microsoft.securityinsights/automationrules/{}" version="2022-06-01-preview" swagger="mgmt-plane/securityinsights/ResourceProviders/Microsoft.SecurityInsights/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuT3BlcmF0aW9uYWxJbnNpZ2h0cy93b3Jrc3BhY2VzL3t3b3Jrc3BhY2VOYW1lfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5SW5zaWdodHMvYXV0b21hdGlvblJ1bGVzL3thdXRvbWF0aW9uUnVsZUlkfQ==/V/MjAyMi0wNi0wMS1wcmV2aWV3"/>
  <commandGroup name="sentinel automation-rule">
    <command name="show" version="2022-06-01-preview">
      <resource id="/subscriptions/{}/resourcegroups/{}/providers/microsoft.operationalinsights/workspaces/{}/providers/microsoft.securityinsights/automationrules/{}" version="2022-06-01-preview" swagger="mgmt-plane/securityinsights/ResourceProviders/Microsoft.SecurityInsights/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuT3BlcmF0aW9uYWxJbnNpZ2h0cy93b3Jrc3BhY2VzL3t3b3Jrc3BhY2VOYW1lfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5SW5zaWdodHMvYXV0b21hdGlvblJ1bGVzL3thdXRvbWF0aW9uUnVsZUlkfQ==/V/MjAyMi0wNi0wMS1wcmV2aWV3"/>
      <argGroup name="">
        <arg type="string" var="$Path.automationRuleId" options="automation-rule-name name n" required="True" stage="Experimental" idPart="child_name_1">
          <help short="Name of automation rule."/>
        </arg>
        <arg type="ResourceGroupName" var="$Path.resourceGroupName" options="resource-group g" required="True" idPart="resource_group"/>
        <arg type="SubscriptionId" var="$Path.subscriptionId" options="subscription" required="True" idPart="subscription"/>
        <arg type="string" var="$Path.workspaceName" options="workspace-name w" required="True" stage="Experimental" idPart="name">
          <help short="The name of the workspace."/>
          <format maxLength="90" minLength="1"/>
        </arg>
      </argGroup>
      <operation operationId="AutomationRules_Get">
        <http path="/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/automationRules/{automationRuleId}">
          <request method="get">
            <path>
              <param type="string" name="automationRuleId" arg="$Path.automationRuleId" required="True"/>
              <param type="string" name="resourceGroupName" arg="$Path.resourceGroupName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
              <param type="string" name="subscriptionId" arg="$Path.subscriptionId" required="True">
                <format minLength="1"/>
              </param>
              <param type="string" name="workspaceName" arg="$Path.workspaceName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
            </path>
            <query>
              <const readOnly="True" const="True" type="string" name="api-version" required="True">
                <default value="&quot;2022-06-01-preview&quot;"/>
                <format minLength="1"/>
              </const>
            </query>
          </request>
          <response statusCode="200">
            <body>
              <json var="$Instance">
                <schema type="object">
                  <prop type="string" name="etag"/>
                  <prop readOnly="True" type="ResourceId" name="id">
                    <format template="/subscriptions/{}/resourceGroups/{}/providers/Microsoft.OperationalInsights/workspaces/{}/providers/Microsoft.SecurityInsights/automationRules/{}"/>
                  </prop>
                  <prop readOnly="True" type="string" name="name"/>
                  <prop type="object" name="properties" required="True" clientFlatten="True">
                    <prop type="array<object>" name="actions" required="True">
                      <item type="object">
                        <prop type="string" name="actionType" required="True">
                          <enum>
                            <item value="&quot;ModifyProperties&quot;"/>
                            <item value="&quot;RunPlaybook&quot;"/>
                          </enum>
                        </prop>
                        <prop type="integer32" name="order" required="True"/>
                        <discriminator property="actionType" value="ModifyProperties">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="classification">
                              <enum>
                                <item value="&quot;BenignPositive&quot;"/>
                                <item value="&quot;FalsePositive&quot;"/>
                                <item value="&quot;TruePositive&quot;"/>
                                <item value="&quot;Undetermined&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="classificationComment"/>
                            <prop type="string" name="classificationReason">
                              <enum>
                                <item value="&quot;InaccurateData&quot;"/>
                                <item value="&quot;IncorrectAlertLogic&quot;"/>
                                <item value="&quot;SuspiciousActivity&quot;"/>
                                <item value="&quot;SuspiciousButExpected&quot;"/>
                              </enum>
                            </prop>
                            <prop type="array<object>" name="labels">
                              <item type="object">
                                <prop type="string" name="labelName" required="True"/>
                                <prop readOnly="True" type="string" name="labelType">
                                  <enum>
                                    <item value="&quot;AutoAssigned&quot;"/>
                                    <item value="&quot;User&quot;"/>
                                  </enum>
                                </prop>
                              </item>
                            </prop>
                            <prop type="object" name="owner">
                              <prop type="string" name="assignedTo"/>
                              <prop type="string" name="email"/>
                              <prop type="uuid" name="objectId"/>
                              <prop type="string" name="ownerType">
                                <enum>
                                  <item value="&quot;Group&quot;"/>
                                  <item value="&quot;Unknown&quot;"/>
                                  <item value="&quot;User&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="userPrincipalName"/>
                            </prop>
                            <prop type="string" name="severity">
                              <enum>
                                <item value="&quot;High&quot;"/>
                                <item value="&quot;Informational&quot;"/>
                                <item value="&quot;Low&quot;"/>
                                <item value="&quot;Medium&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="status">
                              <enum>
                                <item value="&quot;Active&quot;"/>
                                <item value="&quot;Closed&quot;"/>
                                <item value="&quot;New&quot;"/>
                              </enum>
                            </prop>
                          </prop>
                        </discriminator>
                        <discriminator property="actionType" value="RunPlaybook">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="logicAppResourceId"/>
                            <prop type="uuid" name="tenantId"/>
                          </prop>
                        </discriminator>
                      </item>
                    </prop>
                    <prop readOnly="True" type="@ClientInfo_read" name="createdBy"/>
                    <prop readOnly="True" type="dateTime" name="createdTimeUtc"/>
                    <prop type="string" name="displayName" required="True">
                      <format maxLength="500"/>
                    </prop>
                    <prop readOnly="True" type="object" name="lastModifiedBy" cls="ClientInfo_read">
                      <prop readOnly="True" type="string" name="email"/>
                      <prop readOnly="True" type="string" name="name"/>
                      <prop readOnly="True" type="uuid" name="objectId"/>
                      <prop readOnly="True" type="string" name="userPrincipalName"/>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedTimeUtc"/>
                    <prop type="integer32" name="order" required="True">
                      <format maximum="1000" minimum="1"/>
                    </prop>
                    <prop type="object" name="triggeringLogic" required="True">
                      <prop type="array<object>" name="conditions">
                        <item type="object">
                          <prop type="string" name="conditionType" required="True">
                            <enum>
                              <item value="&quot;Property&quot;"/>
                              <item value="&quot;PropertyArrayChanged&quot;"/>
                              <item value="&quot;PropertyChanged&quot;"/>
                            </enum>
                          </prop>
                          <discriminator property="conditionType" value="Property">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;AccountAadTenantId&quot;"/>
                                  <item value="&quot;AccountAadUserId&quot;"/>
                                  <item value="&quot;AccountNTDomain&quot;"/>
                                  <item value="&quot;AccountName&quot;"/>
                                  <item value="&quot;AccountObjectGuid&quot;"/>
                                  <item value="&quot;AccountPUID&quot;"/>
                                  <item value="&quot;AccountSid&quot;"/>
                                  <item value="&quot;AccountUPNSuffix&quot;"/>
                                  <item value="&quot;AlertProductNames&quot;"/>
                                  <item value="&quot;AzureResourceResourceId&quot;"/>
                                  <item value="&quot;AzureResourceSubscriptionId&quot;"/>
                                  <item value="&quot;CloudApplicationAppId&quot;"/>
                                  <item value="&quot;CloudApplicationAppName&quot;"/>
                                  <item value="&quot;DNSDomainName&quot;"/>
                                  <item value="&quot;FileDirectory&quot;"/>
                                  <item value="&quot;FileHashValue&quot;"/>
                                  <item value="&quot;FileName&quot;"/>
                                  <item value="&quot;HostAzureID&quot;"/>
                                  <item value="&quot;HostNTDomain&quot;"/>
                                  <item value="&quot;HostName&quot;"/>
                                  <item value="&quot;HostNetBiosName&quot;"/>
                                  <item value="&quot;HostOSVersion&quot;"/>
                                  <item value="&quot;IPAddress&quot;"/>
                                  <item value="&quot;IncidentDescription&quot;"/>
                                  <item value="&quot;IncidentLabel&quot;"/>
                                  <item value="&quot;IncidentProviderName&quot;"/>
                                  <item value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                  <item value="&quot;IncidentTactics&quot;"/>
                                  <item value="&quot;IncidentTitle&quot;"/>
                                  <item value="&quot;IoTDeviceId&quot;"/>
                                  <item value="&quot;IoTDeviceModel&quot;"/>
                                  <item value="&quot;IoTDeviceName&quot;"/>
                                  <item value="&quot;IoTDeviceOperatingSystem&quot;"/>
                                  <item value="&quot;IoTDeviceType&quot;"/>
                                  <item value="&quot;IoTDeviceVendor&quot;"/>
                                  <item value="&quot;MailMessageDeliveryAction&quot;"/>
                                  <item value="&quot;MailMessageDeliveryLocation&quot;"/>
                                  <item value="&quot;MailMessageP1Sender&quot;"/>
                                  <item value="&quot;MailMessageP2Sender&quot;"/>
                                  <item value="&quot;MailMessageRecipient&quot;"/>
                                  <item value="&quot;MailMessageSenderIP&quot;"/>
                                  <item value="&quot;MailMessageSubject&quot;"/>
                                  <item value="&quot;MailboxDisplayName&quot;"/>
                                  <item value="&quot;MailboxPrimaryAddress&quot;"/>
                                  <item value="&quot;MailboxUPN&quot;"/>
                                  <item value="&quot;MalwareCategory&quot;"/>
                                  <item value="&quot;MalwareName&quot;"/>
                                  <item value="&quot;ProcessCommandLine&quot;"/>
                                  <item value="&quot;ProcessId&quot;"/>
                                  <item value="&quot;RegistryKey&quot;"/>
                                  <item value="&quot;RegistryValueData&quot;"/>
                                  <item value="&quot;Url&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyArrayChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="arrayType">
                                <enum>
                                  <item value="&quot;Alerts&quot;"/>
                                  <item value="&quot;Comments&quot;"/>
                                  <item value="&quot;Labels&quot;"/>
                                  <item value="&quot;Tactics&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;Added&quot;"/>
                                </enum>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;ChangedFrom&quot;"/>
                                  <item value="&quot;ChangedTo&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;IncidentOwner&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                        </item>
                      </prop>
                      <prop type="dateTime" name="expirationTimeUtc"/>
                      <prop type="boolean" name="isEnabled" required="True"/>
                      <prop type="string" name="triggersOn" required="True">
                        <enum>
                          <item value="&quot;Incidents&quot;"/>
                        </enum>
                      </prop>
                      <prop type="string" name="triggersWhen" required="True">
                        <enum>
                          <item value="&quot;Created&quot;"/>
                          <item value="&quot;Updated&quot;"/>
                        </enum>
                      </prop>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="object" name="systemData">
                    <prop readOnly="True" type="dateTime" name="createdAt"/>
                    <prop readOnly="True" type="string" name="createdBy"/>
                    <prop readOnly="True" type="string" name="createdByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedAt"/>
                    <prop readOnly="True" type="string" name="lastModifiedBy"/>
                    <prop readOnly="True" type="string" name="lastModifiedByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="string" name="type"/>
                </schema>
              </json>
            </body>
          </response>
          <response isError="True">
            <body>
              <json>
                <schema type="@ODataV4Format"/>
              </json>
            </body>
          </response>
        </http>
      </operation>
      <output type="object" ref="$Instance" clientFlatten="True"/>
    </command>
    <command name="delete" version="2022-06-01-preview" confirmation="Are you sure you want to perform this operation?">
      <resource id="/subscriptions/{}/resourcegroups/{}/providers/microsoft.operationalinsights/workspaces/{}/providers/microsoft.securityinsights/automationrules/{}" version="2022-06-01-preview" swagger="mgmt-plane/securityinsights/ResourceProviders/Microsoft.SecurityInsights/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuT3BlcmF0aW9uYWxJbnNpZ2h0cy93b3Jrc3BhY2VzL3t3b3Jrc3BhY2VOYW1lfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5SW5zaWdodHMvYXV0b21hdGlvblJ1bGVzL3thdXRvbWF0aW9uUnVsZUlkfQ==/V/MjAyMi0wNi0wMS1wcmV2aWV3"/>
      <argGroup name="">
        <arg type="string" var="$Path.automationRuleId" options="automation-rule-name name n" required="True" stage="Experimental" idPart="child_name_1">
          <help short="Name of automation rule."/>
        </arg>
        <arg type="ResourceGroupName" var="$Path.resourceGroupName" options="resource-group g" required="True" idPart="resource_group"/>
        <arg type="SubscriptionId" var="$Path.subscriptionId" options="subscription" required="True" idPart="subscription"/>
        <arg type="string" var="$Path.workspaceName" options="workspace-name w" required="True" stage="Experimental" idPart="name">
          <help short="The name of the workspace."/>
          <format maxLength="90" minLength="1"/>
        </arg>
      </argGroup>
      <operation operationId="AutomationRules_Delete">
        <http path="/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/automationRules/{automationRuleId}">
          <request method="delete">
            <path>
              <param type="string" name="automationRuleId" arg="$Path.automationRuleId" required="True"/>
              <param type="string" name="resourceGroupName" arg="$Path.resourceGroupName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
              <param type="string" name="subscriptionId" arg="$Path.subscriptionId" required="True">
                <format minLength="1"/>
              </param>
              <param type="string" name="workspaceName" arg="$Path.workspaceName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
            </path>
            <query>
              <const readOnly="True" const="True" type="string" name="api-version" required="True">
                <default value="&quot;2022-06-01-preview&quot;"/>
                <format minLength="1"/>
              </const>
            </query>
          </request>
          <response statusCode="200"/>
          <response statusCode="204"/>
          <response isError="True">
            <body>
              <json>
                <schema type="@ODataV4Format"/>
              </json>
            </body>
          </response>
        </http>
      </operation>
    </command>
    <command name="create" version="2022-06-01-preview">
      <resource id="/subscriptions/{}/resourcegroups/{}/providers/microsoft.operationalinsights/workspaces/{}/providers/microsoft.securityinsights/automationrules/{}" version="2022-06-01-preview" swagger="mgmt-plane/securityinsights/ResourceProviders/Microsoft.SecurityInsights/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuT3BlcmF0aW9uYWxJbnNpZ2h0cy93b3Jrc3BhY2VzL3t3b3Jrc3BhY2VOYW1lfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5SW5zaWdodHMvYXV0b21hdGlvblJ1bGVzL3thdXRvbWF0aW9uUnVsZUlkfQ==/V/MjAyMi0wNi0wMS1wcmV2aWV3"/>
      <argGroup name="">
        <arg type="string" var="$Path.automationRuleId" options="automation-rule-name name n" required="True" stage="Experimental" idPart="child_name_1">
          <help short="Name of automation rule."/>
        </arg>
        <arg type="ResourceGroupName" var="$Path.resourceGroupName" options="resource-group g" required="True" idPart="resource_group"/>
        <arg type="SubscriptionId" var="$Path.subscriptionId" options="subscription" required="True" idPart="subscription"/>
        <arg type="string" var="$Path.workspaceName" options="workspace-name w" required="True" stage="Experimental" idPart="name">
          <help short="The name of the workspace."/>
          <format maxLength="90" minLength="1"/>
        </arg>
      </argGroup>
      <argGroup name="AutomationRuleToUpsert">
        <arg type="string" var="$automationRuleToUpsert.etag" options="etag" group="AutomationRuleToUpsert">
          <help short="Etag of the azure resource"/>
        </arg>
      </argGroup>
      <argGroup name="Properties">
        <arg type="array<object>" var="$automationRuleToUpsert.properties.actions" options="actions" group="Properties">
          <help short="The actions to execute when the automation rule is triggered."/>
          <item type="object">
            <arg type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties" options="modify-properties">
              <arg type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration" options="action-configuration">
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classification" options="classification">
                  <help short="The reason the incident was closed"/>
                  <enum>
                    <item name="BenignPositive" value="&quot;BenignPositive&quot;"/>
                    <item name="FalsePositive" value="&quot;FalsePositive&quot;"/>
                    <item name="TruePositive" value="&quot;TruePositive&quot;"/>
                    <item name="Undetermined" value="&quot;Undetermined&quot;"/>
                  </enum>
                </arg>
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationComment" options="classification-comment">
                  <help short="Describes the reason the incident was closed."/>
                </arg>
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationReason" options="classification-reason">
                  <help short="The classification reason the incident was closed with"/>
                  <enum>
                    <item name="InaccurateData" value="&quot;InaccurateData&quot;"/>
                    <item name="IncorrectAlertLogic" value="&quot;IncorrectAlertLogic&quot;"/>
                    <item name="SuspiciousActivity" value="&quot;SuspiciousActivity&quot;"/>
                    <item name="SuspiciousButExpected" value="&quot;SuspiciousButExpected&quot;"/>
                  </enum>
                </arg>
                <arg type="array<object>" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels" options="labels">
                  <help short="List of labels to add to the incident."/>
                  <item type="object">
                    <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels[].labelName" options="label-name" required="True">
                      <help short="The name of the label"/>
                    </arg>
                  </item>
                </arg>
                <arg type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner" options="owner">
                  <help short="Information on the user an incident is assigned to"/>
                  <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.assignedTo" options="assigned-to">
                    <help short="The name of the user the incident is assigned to."/>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.email" options="email">
                    <help short="The email of the user the incident is assigned to."/>
                  </arg>
                  <arg type="uuid" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.objectId" options="object-id">
                    <help short="The object id of the user the incident is assigned to."/>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.ownerType" options="owner-type">
                    <help short="The type of the owner the incident is assigned to."/>
                    <enum>
                      <item name="Group" value="&quot;Group&quot;"/>
                      <item name="Unknown" value="&quot;Unknown&quot;"/>
                      <item name="User" value="&quot;User&quot;"/>
                    </enum>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.userPrincipalName" options="user-principal-name">
                    <help short="The user principal name of the user the incident is assigned to."/>
                  </arg>
                </arg>
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.severity" options="severity">
                  <help short="The severity of the incident"/>
                  <enum>
                    <item name="High" value="&quot;High&quot;"/>
                    <item name="Informational" value="&quot;Informational&quot;"/>
                    <item name="Low" value="&quot;Low&quot;"/>
                    <item name="Medium" value="&quot;Medium&quot;"/>
                  </enum>
                </arg>
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.status" options="status">
                  <help short="The status of the incident"/>
                  <enum>
                    <item name="Active" value="&quot;Active&quot;"/>
                    <item name="Closed" value="&quot;Closed&quot;"/>
                    <item name="New" value="&quot;New&quot;"/>
                  </enum>
                </arg>
              </arg>
            </arg>
            <arg type="object" var="$automationRuleToUpsert.properties.actions[].RunPlaybook" options="run-playbook">
              <arg type="object" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration" options="action-configuration">
                <arg type="string" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.logicAppResourceId" options="logic-app-resource-id">
                  <help short="The resource id of the playbook resource."/>
                </arg>
                <arg type="uuid" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.tenantId" options="tenant-id">
                  <help short="The tenant id of the playbook resource."/>
                </arg>
              </arg>
            </arg>
            <arg type="integer32" var="$automationRuleToUpsert.properties.actions[].order" options="order" required="True"/>
          </item>
        </arg>
        <arg type="string" var="$automationRuleToUpsert.properties.displayName" options="display-name" group="Properties">
          <help short="The display name of the automation rule."/>
          <format maxLength="500"/>
        </arg>
        <arg type="integer32" var="$automationRuleToUpsert.properties.order" options="order" group="Properties">
          <help short="The order of execution of the automation rule."/>
          <format maximum="1000" minimum="1"/>
        </arg>
        <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic" options="triggering-logic" group="Properties">
          <help short="Describes automation rule triggering logic."/>
          <arg type="array<object>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions" options="conditions">
            <help short="The conditions to evaluate to determine if the automation rule should be triggered on a given object."/>
            <item type="object">
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property" options="property">
                <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties" options="condition-properties">
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.operator" options="operator">
                    <enum>
                      <item name="Contains" value="&quot;Contains&quot;"/>
                      <item name="EndsWith" value="&quot;EndsWith&quot;"/>
                      <item name="Equals" value="&quot;Equals&quot;"/>
                      <item name="NotContains" value="&quot;NotContains&quot;"/>
                      <item name="NotEndsWith" value="&quot;NotEndsWith&quot;"/>
                      <item name="NotEquals" value="&quot;NotEquals&quot;"/>
                      <item name="NotStartsWith" value="&quot;NotStartsWith&quot;"/>
                      <item name="StartsWith" value="&quot;StartsWith&quot;"/>
                    </enum>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyName" options="property-name">
                    <help short="The property to evaluate in an automation rule property condition."/>
                    <enum>
                      <item name="AccountAadTenantId" value="&quot;AccountAadTenantId&quot;"/>
                      <item name="AccountAadUserId" value="&quot;AccountAadUserId&quot;"/>
                      <item name="AccountNTDomain" value="&quot;AccountNTDomain&quot;"/>
                      <item name="AccountName" value="&quot;AccountName&quot;"/>
                      <item name="AccountObjectGuid" value="&quot;AccountObjectGuid&quot;"/>
                      <item name="AccountPUID" value="&quot;AccountPUID&quot;"/>
                      <item name="AccountSid" value="&quot;AccountSid&quot;"/>
                      <item name="AccountUPNSuffix" value="&quot;AccountUPNSuffix&quot;"/>
                      <item name="AlertProductNames" value="&quot;AlertProductNames&quot;"/>
                      <item name="AzureResourceResourceId" value="&quot;AzureResourceResourceId&quot;"/>
                      <item name="AzureResourceSubscriptionId" value="&quot;AzureResourceSubscriptionId&quot;"/>
                      <item name="CloudApplicationAppId" value="&quot;CloudApplicationAppId&quot;"/>
                      <item name="CloudApplicationAppName" value="&quot;CloudApplicationAppName&quot;"/>
                      <item name="DNSDomainName" value="&quot;DNSDomainName&quot;"/>
                      <item name="FileDirectory" value="&quot;FileDirectory&quot;"/>
                      <item name="FileHashValue" value="&quot;FileHashValue&quot;"/>
                      <item name="FileName" value="&quot;FileName&quot;"/>
                      <item name="HostAzureID" value="&quot;HostAzureID&quot;"/>
                      <item name="HostNTDomain" value="&quot;HostNTDomain&quot;"/>
                      <item name="HostName" value="&quot;HostName&quot;"/>
                      <item name="HostNetBiosName" value="&quot;HostNetBiosName&quot;"/>
                      <item name="HostOSVersion" value="&quot;HostOSVersion&quot;"/>
                      <item name="IPAddress" value="&quot;IPAddress&quot;"/>
                      <item name="IncidentDescription" value="&quot;IncidentDescription&quot;"/>
                      <item name="IncidentLabel" value="&quot;IncidentLabel&quot;"/>
                      <item name="IncidentProviderName" value="&quot;IncidentProviderName&quot;"/>
                      <item name="IncidentRelatedAnalyticRuleIds" value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                      <item name="IncidentSeverity" value="&quot;IncidentSeverity&quot;"/>
                      <item name="IncidentStatus" value="&quot;IncidentStatus&quot;"/>
                      <item name="IncidentTactics" value="&quot;IncidentTactics&quot;"/>
                      <item name="IncidentTitle" value="&quot;IncidentTitle&quot;"/>
                      <item name="IoTDeviceId" value="&quot;IoTDeviceId&quot;"/>
                      <item name="IoTDeviceModel" value="&quot;IoTDeviceModel&quot;"/>
                      <item name="IoTDeviceName" value="&quot;IoTDeviceName&quot;"/>
                      <item name="IoTDeviceOperatingSystem" value="&quot;IoTDeviceOperatingSystem&quot;"/>
                      <item name="IoTDeviceType" value="&quot;IoTDeviceType&quot;"/>
                      <item name="IoTDeviceVendor" value="&quot;IoTDeviceVendor&quot;"/>
                      <item name="MailMessageDeliveryAction" value="&quot;MailMessageDeliveryAction&quot;"/>
                      <item name="MailMessageDeliveryLocation" value="&quot;MailMessageDeliveryLocation&quot;"/>
                      <item name="MailMessageP1Sender" value="&quot;MailMessageP1Sender&quot;"/>
                      <item name="MailMessageP2Sender" value="&quot;MailMessageP2Sender&quot;"/>
                      <item name="MailMessageRecipient" value="&quot;MailMessageRecipient&quot;"/>
                      <item name="MailMessageSenderIP" value="&quot;MailMessageSenderIP&quot;"/>
                      <item name="MailMessageSubject" value="&quot;MailMessageSubject&quot;"/>
                      <item name="MailboxDisplayName" value="&quot;MailboxDisplayName&quot;"/>
                      <item name="MailboxPrimaryAddress" value="&quot;MailboxPrimaryAddress&quot;"/>
                      <item name="MailboxUPN" value="&quot;MailboxUPN&quot;"/>
                      <item name="MalwareCategory" value="&quot;MalwareCategory&quot;"/>
                      <item name="MalwareName" value="&quot;MalwareName&quot;"/>
                      <item name="ProcessCommandLine" value="&quot;ProcessCommandLine&quot;"/>
                      <item name="ProcessId" value="&quot;ProcessId&quot;"/>
                      <item name="RegistryKey" value="&quot;RegistryKey&quot;"/>
                      <item name="RegistryValueData" value="&quot;RegistryValueData&quot;"/>
                      <item name="Url" value="&quot;Url&quot;"/>
                    </enum>
                  </arg>
                  <arg type="array<string>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyValues" options="property-values">
                    <item type="string"/>
                  </arg>
                </arg>
              </arg>
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged" options="property-array-changed">
                <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties" options="condition-properties">
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.arrayType" options="array-type">
                    <enum>
                      <item name="Alerts" value="&quot;Alerts&quot;"/>
                      <item name="Comments" value="&quot;Comments&quot;"/>
                      <item name="Labels" value="&quot;Labels&quot;"/>
                      <item name="Tactics" value="&quot;Tactics&quot;"/>
                    </enum>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.changeType" options="change-type">
                    <enum>
                      <item name="Added" value="&quot;Added&quot;"/>
                    </enum>
                  </arg>
                </arg>
              </arg>
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged" options="property-changed">
                <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties" options="condition-properties">
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.changeType" options="change-type">
                    <enum>
                      <item name="ChangedFrom" value="&quot;ChangedFrom&quot;"/>
                      <item name="ChangedTo" value="&quot;ChangedTo&quot;"/>
                    </enum>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.operator" options="operator">
                    <enum>
                      <item name="Contains" value="&quot;Contains&quot;"/>
                      <item name="EndsWith" value="&quot;EndsWith&quot;"/>
                      <item name="Equals" value="&quot;Equals&quot;"/>
                      <item name="NotContains" value="&quot;NotContains&quot;"/>
                      <item name="NotEndsWith" value="&quot;NotEndsWith&quot;"/>
                      <item name="NotEquals" value="&quot;NotEquals&quot;"/>
                      <item name="NotStartsWith" value="&quot;NotStartsWith&quot;"/>
                      <item name="StartsWith" value="&quot;StartsWith&quot;"/>
                    </enum>
                  </arg>
                  <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyName" options="property-name">
                    <enum>
                      <item name="IncidentOwner" value="&quot;IncidentOwner&quot;"/>
                      <item name="IncidentSeverity" value="&quot;IncidentSeverity&quot;"/>
                      <item name="IncidentStatus" value="&quot;IncidentStatus&quot;"/>
                    </enum>
                  </arg>
                  <arg type="array<string>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyValues" options="property-values">
                    <item type="string"/>
                  </arg>
                </arg>
              </arg>
            </item>
          </arg>
          <arg type="dateTime" var="$automationRuleToUpsert.properties.triggeringLogic.expirationTimeUtc" options="expiration-time-utc">
            <help short="Determines when the automation rule should automatically expire and be disabled."/>
          </arg>
          <arg type="boolean" var="$automationRuleToUpsert.properties.triggeringLogic.isEnabled" options="is-enabled" required="True">
            <help short="Determines whether the automation rule is enabled or disabled."/>
          </arg>
          <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.triggersOn" options="triggers-on" required="True">
            <enum>
              <item name="Incidents" value="&quot;Incidents&quot;"/>
            </enum>
          </arg>
          <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.triggersWhen" options="triggers-when" required="True">
            <enum>
              <item name="Created" value="&quot;Created&quot;"/>
              <item name="Updated" value="&quot;Updated&quot;"/>
            </enum>
          </arg>
        </arg>
      </argGroup>
      <operation operationId="AutomationRules_CreateOrUpdate">
        <http path="/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/automationRules/{automationRuleId}">
          <request method="put">
            <path>
              <param type="string" name="automationRuleId" arg="$Path.automationRuleId" required="True"/>
              <param type="string" name="resourceGroupName" arg="$Path.resourceGroupName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
              <param type="string" name="subscriptionId" arg="$Path.subscriptionId" required="True">
                <format minLength="1"/>
              </param>
              <param type="string" name="workspaceName" arg="$Path.workspaceName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
            </path>
            <query>
              <const readOnly="True" const="True" type="string" name="api-version" required="True">
                <default value="&quot;2022-06-01-preview&quot;"/>
                <format minLength="1"/>
              </const>
            </query>
            <body>
              <json>
                <schema type="object" name="automationRuleToUpsert" clientFlatten="True">
                  <prop type="string" name="etag" arg="$automationRuleToUpsert.etag"/>
                  <prop type="object" name="properties" required="True" clientFlatten="True">
                    <prop type="array<object>" name="actions" arg="$automationRuleToUpsert.properties.actions" required="True">
                      <item type="object">
                        <prop type="string" name="actionType" required="True">
                          <enum>
                            <item arg="$automationRuleToUpsert.properties.actions[].ModifyProperties" value="&quot;ModifyProperties&quot;"/>
                            <item arg="$automationRuleToUpsert.properties.actions[].RunPlaybook" value="&quot;RunPlaybook&quot;"/>
                          </enum>
                        </prop>
                        <prop type="integer32" name="order" arg="$automationRuleToUpsert.properties.actions[].order" required="True"/>
                        <discriminator property="actionType" value="ModifyProperties">
                          <prop type="object" name="actionConfiguration" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration">
                            <prop type="string" name="classification" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classification">
                              <enum>
                                <item value="&quot;BenignPositive&quot;"/>
                                <item value="&quot;FalsePositive&quot;"/>
                                <item value="&quot;TruePositive&quot;"/>
                                <item value="&quot;Undetermined&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="classificationComment" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationComment"/>
                            <prop type="string" name="classificationReason" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationReason">
                              <enum>
                                <item value="&quot;InaccurateData&quot;"/>
                                <item value="&quot;IncorrectAlertLogic&quot;"/>
                                <item value="&quot;SuspiciousActivity&quot;"/>
                                <item value="&quot;SuspiciousButExpected&quot;"/>
                              </enum>
                            </prop>
                            <prop type="array<object>" name="labels" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels">
                              <item type="object">
                                <prop type="string" name="labelName" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels[].labelName" required="True"/>
                              </item>
                            </prop>
                            <prop type="object" name="owner" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner">
                              <prop type="string" name="assignedTo" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.assignedTo"/>
                              <prop type="string" name="email" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.email"/>
                              <prop type="uuid" name="objectId" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.objectId"/>
                              <prop type="string" name="ownerType" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.ownerType">
                                <enum>
                                  <item value="&quot;Group&quot;"/>
                                  <item value="&quot;Unknown&quot;"/>
                                  <item value="&quot;User&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="userPrincipalName" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.userPrincipalName"/>
                            </prop>
                            <prop type="string" name="severity" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.severity">
                              <enum>
                                <item value="&quot;High&quot;"/>
                                <item value="&quot;Informational&quot;"/>
                                <item value="&quot;Low&quot;"/>
                                <item value="&quot;Medium&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="status" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.status">
                              <enum>
                                <item value="&quot;Active&quot;"/>
                                <item value="&quot;Closed&quot;"/>
                                <item value="&quot;New&quot;"/>
                              </enum>
                            </prop>
                          </prop>
                        </discriminator>
                        <discriminator property="actionType" value="RunPlaybook">
                          <prop type="object" name="actionConfiguration" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration">
                            <prop type="string" name="logicAppResourceId" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.logicAppResourceId"/>
                            <prop type="uuid" name="tenantId" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.tenantId"/>
                          </prop>
                        </discriminator>
                      </item>
                    </prop>
                    <prop type="string" name="displayName" arg="$automationRuleToUpsert.properties.displayName" required="True">
                      <format maxLength="500"/>
                    </prop>
                    <prop type="integer32" name="order" arg="$automationRuleToUpsert.properties.order" required="True">
                      <format maximum="1000" minimum="1"/>
                    </prop>
                    <prop type="object" name="triggeringLogic" arg="$automationRuleToUpsert.properties.triggeringLogic" required="True">
                      <prop type="array<object>" name="conditions" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions">
                        <item type="object">
                          <prop type="string" name="conditionType" required="True">
                            <enum>
                              <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property" value="&quot;Property&quot;"/>
                              <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged" value="&quot;PropertyArrayChanged&quot;"/>
                              <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged" value="&quot;PropertyChanged&quot;"/>
                            </enum>
                          </prop>
                          <discriminator property="conditionType" value="Property">
                            <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties">
                              <prop type="string" name="operator" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyName">
                                <enum>
                                  <item value="&quot;AccountAadTenantId&quot;"/>
                                  <item value="&quot;AccountAadUserId&quot;"/>
                                  <item value="&quot;AccountNTDomain&quot;"/>
                                  <item value="&quot;AccountName&quot;"/>
                                  <item value="&quot;AccountObjectGuid&quot;"/>
                                  <item value="&quot;AccountPUID&quot;"/>
                                  <item value="&quot;AccountSid&quot;"/>
                                  <item value="&quot;AccountUPNSuffix&quot;"/>
                                  <item value="&quot;AlertProductNames&quot;"/>
                                  <item value="&quot;AzureResourceResourceId&quot;"/>
                                  <item value="&quot;AzureResourceSubscriptionId&quot;"/>
                                  <item value="&quot;CloudApplicationAppId&quot;"/>
                                  <item value="&quot;CloudApplicationAppName&quot;"/>
                                  <item value="&quot;DNSDomainName&quot;"/>
                                  <item value="&quot;FileDirectory&quot;"/>
                                  <item value="&quot;FileHashValue&quot;"/>
                                  <item value="&quot;FileName&quot;"/>
                                  <item value="&quot;HostAzureID&quot;"/>
                                  <item value="&quot;HostNTDomain&quot;"/>
                                  <item value="&quot;HostName&quot;"/>
                                  <item value="&quot;HostNetBiosName&quot;"/>
                                  <item value="&quot;HostOSVersion&quot;"/>
                                  <item value="&quot;IPAddress&quot;"/>
                                  <item value="&quot;IncidentDescription&quot;"/>
                                  <item value="&quot;IncidentLabel&quot;"/>
                                  <item value="&quot;IncidentProviderName&quot;"/>
                                  <item value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                  <item value="&quot;IncidentTactics&quot;"/>
                                  <item value="&quot;IncidentTitle&quot;"/>
                                  <item value="&quot;IoTDeviceId&quot;"/>
                                  <item value="&quot;IoTDeviceModel&quot;"/>
                                  <item value="&quot;IoTDeviceName&quot;"/>
                                  <item value="&quot;IoTDeviceOperatingSystem&quot;"/>
                                  <item value="&quot;IoTDeviceType&quot;"/>
                                  <item value="&quot;IoTDeviceVendor&quot;"/>
                                  <item value="&quot;MailMessageDeliveryAction&quot;"/>
                                  <item value="&quot;MailMessageDeliveryLocation&quot;"/>
                                  <item value="&quot;MailMessageP1Sender&quot;"/>
                                  <item value="&quot;MailMessageP2Sender&quot;"/>
                                  <item value="&quot;MailMessageRecipient&quot;"/>
                                  <item value="&quot;MailMessageSenderIP&quot;"/>
                                  <item value="&quot;MailMessageSubject&quot;"/>
                                  <item value="&quot;MailboxDisplayName&quot;"/>
                                  <item value="&quot;MailboxPrimaryAddress&quot;"/>
                                  <item value="&quot;MailboxUPN&quot;"/>
                                  <item value="&quot;MalwareCategory&quot;"/>
                                  <item value="&quot;MalwareName&quot;"/>
                                  <item value="&quot;ProcessCommandLine&quot;"/>
                                  <item value="&quot;ProcessId&quot;"/>
                                  <item value="&quot;RegistryKey&quot;"/>
                                  <item value="&quot;RegistryValueData&quot;"/>
                                  <item value="&quot;Url&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyArrayChanged">
                            <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties">
                              <prop type="string" name="arrayType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.arrayType">
                                <enum>
                                  <item value="&quot;Alerts&quot;"/>
                                  <item value="&quot;Comments&quot;"/>
                                  <item value="&quot;Labels&quot;"/>
                                  <item value="&quot;Tactics&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="changeType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.changeType">
                                <enum>
                                  <item value="&quot;Added&quot;"/>
                                </enum>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyChanged">
                            <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties">
                              <prop type="string" name="changeType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.changeType">
                                <enum>
                                  <item value="&quot;ChangedFrom&quot;"/>
                                  <item value="&quot;ChangedTo&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="operator" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyName">
                                <enum>
                                  <item value="&quot;IncidentOwner&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                        </item>
                      </prop>
                      <prop type="dateTime" name="expirationTimeUtc" arg="$automationRuleToUpsert.properties.triggeringLogic.expirationTimeUtc"/>
                      <prop type="boolean" name="isEnabled" arg="$automationRuleToUpsert.properties.triggeringLogic.isEnabled" required="True"/>
                      <prop type="string" name="triggersOn" arg="$automationRuleToUpsert.properties.triggeringLogic.triggersOn" required="True">
                        <enum>
                          <item value="&quot;Incidents&quot;"/>
                        </enum>
                      </prop>
                      <prop type="string" name="triggersWhen" arg="$automationRuleToUpsert.properties.triggeringLogic.triggersWhen" required="True">
                        <enum>
                          <item value="&quot;Created&quot;"/>
                          <item value="&quot;Updated&quot;"/>
                        </enum>
                      </prop>
                    </prop>
                  </prop>
                </schema>
              </json>
            </body>
          </request>
          <response statusCode="200 201">
            <body>
              <json var="$Instance">
                <schema type="object">
                  <prop type="string" name="etag"/>
                  <prop readOnly="True" type="ResourceId" name="id">
                    <format template="/subscriptions/{}/resourceGroups/{}/providers/Microsoft.OperationalInsights/workspaces/{}/providers/Microsoft.SecurityInsights/automationRules/{}"/>
                  </prop>
                  <prop readOnly="True" type="string" name="name"/>
                  <prop type="object" name="properties" required="True" clientFlatten="True">
                    <prop type="array<object>" name="actions" required="True">
                      <item type="object">
                        <prop type="string" name="actionType" required="True">
                          <enum>
                            <item value="&quot;ModifyProperties&quot;"/>
                            <item value="&quot;RunPlaybook&quot;"/>
                          </enum>
                        </prop>
                        <prop type="integer32" name="order" required="True"/>
                        <discriminator property="actionType" value="ModifyProperties">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="classification">
                              <enum>
                                <item value="&quot;BenignPositive&quot;"/>
                                <item value="&quot;FalsePositive&quot;"/>
                                <item value="&quot;TruePositive&quot;"/>
                                <item value="&quot;Undetermined&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="classificationComment"/>
                            <prop type="string" name="classificationReason">
                              <enum>
                                <item value="&quot;InaccurateData&quot;"/>
                                <item value="&quot;IncorrectAlertLogic&quot;"/>
                                <item value="&quot;SuspiciousActivity&quot;"/>
                                <item value="&quot;SuspiciousButExpected&quot;"/>
                              </enum>
                            </prop>
                            <prop type="array<object>" name="labels">
                              <item type="object">
                                <prop type="string" name="labelName" required="True"/>
                                <prop readOnly="True" type="string" name="labelType">
                                  <enum>
                                    <item value="&quot;AutoAssigned&quot;"/>
                                    <item value="&quot;User&quot;"/>
                                  </enum>
                                </prop>
                              </item>
                            </prop>
                            <prop type="object" name="owner">
                              <prop type="string" name="assignedTo"/>
                              <prop type="string" name="email"/>
                              <prop type="uuid" name="objectId"/>
                              <prop type="string" name="ownerType">
                                <enum>
                                  <item value="&quot;Group&quot;"/>
                                  <item value="&quot;Unknown&quot;"/>
                                  <item value="&quot;User&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="userPrincipalName"/>
                            </prop>
                            <prop type="string" name="severity">
                              <enum>
                                <item value="&quot;High&quot;"/>
                                <item value="&quot;Informational&quot;"/>
                                <item value="&quot;Low&quot;"/>
                                <item value="&quot;Medium&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="status">
                              <enum>
                                <item value="&quot;Active&quot;"/>
                                <item value="&quot;Closed&quot;"/>
                                <item value="&quot;New&quot;"/>
                              </enum>
                            </prop>
                          </prop>
                        </discriminator>
                        <discriminator property="actionType" value="RunPlaybook">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="logicAppResourceId"/>
                            <prop type="uuid" name="tenantId"/>
                          </prop>
                        </discriminator>
                      </item>
                    </prop>
                    <prop readOnly="True" type="@ClientInfo_read" name="createdBy"/>
                    <prop readOnly="True" type="dateTime" name="createdTimeUtc"/>
                    <prop type="string" name="displayName" required="True">
                      <format maxLength="500"/>
                    </prop>
                    <prop readOnly="True" type="object" name="lastModifiedBy" cls="ClientInfo_read">
                      <prop readOnly="True" type="string" name="email"/>
                      <prop readOnly="True" type="string" name="name"/>
                      <prop readOnly="True" type="uuid" name="objectId"/>
                      <prop readOnly="True" type="string" name="userPrincipalName"/>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedTimeUtc"/>
                    <prop type="integer32" name="order" required="True">
                      <format maximum="1000" minimum="1"/>
                    </prop>
                    <prop type="object" name="triggeringLogic" required="True">
                      <prop type="array<object>" name="conditions">
                        <item type="object">
                          <prop type="string" name="conditionType" required="True">
                            <enum>
                              <item value="&quot;Property&quot;"/>
                              <item value="&quot;PropertyArrayChanged&quot;"/>
                              <item value="&quot;PropertyChanged&quot;"/>
                            </enum>
                          </prop>
                          <discriminator property="conditionType" value="Property">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;AccountAadTenantId&quot;"/>
                                  <item value="&quot;AccountAadUserId&quot;"/>
                                  <item value="&quot;AccountNTDomain&quot;"/>
                                  <item value="&quot;AccountName&quot;"/>
                                  <item value="&quot;AccountObjectGuid&quot;"/>
                                  <item value="&quot;AccountPUID&quot;"/>
                                  <item value="&quot;AccountSid&quot;"/>
                                  <item value="&quot;AccountUPNSuffix&quot;"/>
                                  <item value="&quot;AlertProductNames&quot;"/>
                                  <item value="&quot;AzureResourceResourceId&quot;"/>
                                  <item value="&quot;AzureResourceSubscriptionId&quot;"/>
                                  <item value="&quot;CloudApplicationAppId&quot;"/>
                                  <item value="&quot;CloudApplicationAppName&quot;"/>
                                  <item value="&quot;DNSDomainName&quot;"/>
                                  <item value="&quot;FileDirectory&quot;"/>
                                  <item value="&quot;FileHashValue&quot;"/>
                                  <item value="&quot;FileName&quot;"/>
                                  <item value="&quot;HostAzureID&quot;"/>
                                  <item value="&quot;HostNTDomain&quot;"/>
                                  <item value="&quot;HostName&quot;"/>
                                  <item value="&quot;HostNetBiosName&quot;"/>
                                  <item value="&quot;HostOSVersion&quot;"/>
                                  <item value="&quot;IPAddress&quot;"/>
                                  <item value="&quot;IncidentDescription&quot;"/>
                                  <item value="&quot;IncidentLabel&quot;"/>
                                  <item value="&quot;IncidentProviderName&quot;"/>
                                  <item value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                  <item value="&quot;IncidentTactics&quot;"/>
                                  <item value="&quot;IncidentTitle&quot;"/>
                                  <item value="&quot;IoTDeviceId&quot;"/>
                                  <item value="&quot;IoTDeviceModel&quot;"/>
                                  <item value="&quot;IoTDeviceName&quot;"/>
                                  <item value="&quot;IoTDeviceOperatingSystem&quot;"/>
                                  <item value="&quot;IoTDeviceType&quot;"/>
                                  <item value="&quot;IoTDeviceVendor&quot;"/>
                                  <item value="&quot;MailMessageDeliveryAction&quot;"/>
                                  <item value="&quot;MailMessageDeliveryLocation&quot;"/>
                                  <item value="&quot;MailMessageP1Sender&quot;"/>
                                  <item value="&quot;MailMessageP2Sender&quot;"/>
                                  <item value="&quot;MailMessageRecipient&quot;"/>
                                  <item value="&quot;MailMessageSenderIP&quot;"/>
                                  <item value="&quot;MailMessageSubject&quot;"/>
                                  <item value="&quot;MailboxDisplayName&quot;"/>
                                  <item value="&quot;MailboxPrimaryAddress&quot;"/>
                                  <item value="&quot;MailboxUPN&quot;"/>
                                  <item value="&quot;MalwareCategory&quot;"/>
                                  <item value="&quot;MalwareName&quot;"/>
                                  <item value="&quot;ProcessCommandLine&quot;"/>
                                  <item value="&quot;ProcessId&quot;"/>
                                  <item value="&quot;RegistryKey&quot;"/>
                                  <item value="&quot;RegistryValueData&quot;"/>
                                  <item value="&quot;Url&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyArrayChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="arrayType">
                                <enum>
                                  <item value="&quot;Alerts&quot;"/>
                                  <item value="&quot;Comments&quot;"/>
                                  <item value="&quot;Labels&quot;"/>
                                  <item value="&quot;Tactics&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;Added&quot;"/>
                                </enum>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;ChangedFrom&quot;"/>
                                  <item value="&quot;ChangedTo&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;IncidentOwner&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                        </item>
                      </prop>
                      <prop type="dateTime" name="expirationTimeUtc"/>
                      <prop type="boolean" name="isEnabled" required="True"/>
                      <prop type="string" name="triggersOn" required="True">
                        <enum>
                          <item value="&quot;Incidents&quot;"/>
                        </enum>
                      </prop>
                      <prop type="string" name="triggersWhen" required="True">
                        <enum>
                          <item value="&quot;Created&quot;"/>
                          <item value="&quot;Updated&quot;"/>
                        </enum>
                      </prop>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="object" name="systemData">
                    <prop readOnly="True" type="dateTime" name="createdAt"/>
                    <prop readOnly="True" type="string" name="createdBy"/>
                    <prop readOnly="True" type="string" name="createdByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedAt"/>
                    <prop readOnly="True" type="string" name="lastModifiedBy"/>
                    <prop readOnly="True" type="string" name="lastModifiedByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="string" name="type"/>
                </schema>
              </json>
            </body>
          </response>
          <response isError="True">
            <body>
              <json>
                <schema type="@ODataV4Format"/>
              </json>
            </body>
          </response>
        </http>
      </operation>
      <output type="object" ref="$Instance" clientFlatten="True"/>
    </command>
    <command name="update" version="2022-06-01-preview">
      <resource id="/subscriptions/{}/resourcegroups/{}/providers/microsoft.operationalinsights/workspaces/{}/providers/microsoft.securityinsights/automationrules/{}" version="2022-06-01-preview" swagger="mgmt-plane/securityinsights/ResourceProviders/Microsoft.SecurityInsights/Paths/L3N1YnNjcmlwdGlvbnMve3N1YnNjcmlwdGlvbklkfS9yZXNvdXJjZUdyb3Vwcy97cmVzb3VyY2VHcm91cE5hbWV9L3Byb3ZpZGVycy9NaWNyb3NvZnQuT3BlcmF0aW9uYWxJbnNpZ2h0cy93b3Jrc3BhY2VzL3t3b3Jrc3BhY2VOYW1lfS9wcm92aWRlcnMvTWljcm9zb2Z0LlNlY3VyaXR5SW5zaWdodHMvYXV0b21hdGlvblJ1bGVzL3thdXRvbWF0aW9uUnVsZUlkfQ==/V/MjAyMi0wNi0wMS1wcmV2aWV3"/>
      <argGroup name="">
        <arg type="string" var="$Path.automationRuleId" options="automation-rule-name name n" required="True" stage="Experimental" idPart="child_name_1">
          <help short="Name of automation rule."/>
        </arg>
        <arg type="ResourceGroupName" var="$Path.resourceGroupName" options="resource-group g" required="True" idPart="resource_group"/>
        <arg type="SubscriptionId" var="$Path.subscriptionId" options="subscription" required="True" idPart="subscription"/>
        <arg type="string" var="$Path.workspaceName" options="workspace-name w" required="True" stage="Experimental" idPart="name">
          <help short="The name of the workspace."/>
          <format maxLength="90" minLength="1"/>
        </arg>
      </argGroup>
      <argGroup name="AutomationRuleToUpsert">
        <arg nullable="True" type="string" var="$automationRuleToUpsert.etag" options="etag" group="AutomationRuleToUpsert">
          <help short="Etag of the azure resource"/>
        </arg>
      </argGroup>
      <argGroup name="Properties">
        <arg type="array<object>" var="$automationRuleToUpsert.properties.actions" options="actions" group="Properties">
          <help short="The actions to execute when the automation rule is triggered."/>
          <item type="object">
            <arg type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties" options="modify-properties">
              <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration" options="action-configuration">
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classification" options="classification">
                  <help short="The reason the incident was closed"/>
                  <enum>
                    <item name="BenignPositive" value="&quot;BenignPositive&quot;"/>
                    <item name="FalsePositive" value="&quot;FalsePositive&quot;"/>
                    <item name="TruePositive" value="&quot;TruePositive&quot;"/>
                    <item name="Undetermined" value="&quot;Undetermined&quot;"/>
                  </enum>
                </arg>
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationComment" options="classification-comment">
                  <help short="Describes the reason the incident was closed."/>
                </arg>
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationReason" options="classification-reason">
                  <help short="The classification reason the incident was closed with"/>
                  <enum>
                    <item name="InaccurateData" value="&quot;InaccurateData&quot;"/>
                    <item name="IncorrectAlertLogic" value="&quot;IncorrectAlertLogic&quot;"/>
                    <item name="SuspiciousActivity" value="&quot;SuspiciousActivity&quot;"/>
                    <item name="SuspiciousButExpected" value="&quot;SuspiciousButExpected&quot;"/>
                  </enum>
                </arg>
                <arg nullable="True" type="array<object>" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels" options="labels">
                  <help short="List of labels to add to the incident."/>
                  <item type="object">
                    <arg type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels[].labelName" options="label-name">
                      <help short="The name of the label"/>
                    </arg>
                  </item>
                </arg>
                <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner" options="owner">
                  <help short="Information on the user an incident is assigned to"/>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.assignedTo" options="assigned-to">
                    <help short="The name of the user the incident is assigned to."/>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.email" options="email">
                    <help short="The email of the user the incident is assigned to."/>
                  </arg>
                  <arg nullable="True" type="uuid" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.objectId" options="object-id">
                    <help short="The object id of the user the incident is assigned to."/>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.ownerType" options="owner-type">
                    <help short="The type of the owner the incident is assigned to."/>
                    <enum>
                      <item name="Group" value="&quot;Group&quot;"/>
                      <item name="Unknown" value="&quot;Unknown&quot;"/>
                      <item name="User" value="&quot;User&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.userPrincipalName" options="user-principal-name">
                    <help short="The user principal name of the user the incident is assigned to."/>
                  </arg>
                </arg>
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.severity" options="severity">
                  <help short="The severity of the incident"/>
                  <enum>
                    <item name="High" value="&quot;High&quot;"/>
                    <item name="Informational" value="&quot;Informational&quot;"/>
                    <item name="Low" value="&quot;Low&quot;"/>
                    <item name="Medium" value="&quot;Medium&quot;"/>
                  </enum>
                </arg>
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.status" options="status">
                  <help short="The status of the incident"/>
                  <enum>
                    <item name="Active" value="&quot;Active&quot;"/>
                    <item name="Closed" value="&quot;Closed&quot;"/>
                    <item name="New" value="&quot;New&quot;"/>
                  </enum>
                </arg>
              </arg>
            </arg>
            <arg type="object" var="$automationRuleToUpsert.properties.actions[].RunPlaybook" options="run-playbook">
              <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration" options="action-configuration">
                <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.logicAppResourceId" options="logic-app-resource-id">
                  <help short="The resource id of the playbook resource."/>
                </arg>
                <arg nullable="True" type="uuid" var="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.tenantId" options="tenant-id">
                  <help short="The tenant id of the playbook resource."/>
                </arg>
              </arg>
            </arg>
            <arg type="integer32" var="$automationRuleToUpsert.properties.actions[].order" options="order"/>
          </item>
        </arg>
        <arg type="string" var="$automationRuleToUpsert.properties.displayName" options="display-name" group="Properties">
          <help short="The display name of the automation rule."/>
          <format maxLength="500"/>
        </arg>
        <arg type="integer32" var="$automationRuleToUpsert.properties.order" options="order" group="Properties">
          <help short="The order of execution of the automation rule."/>
          <format maximum="1000" minimum="1"/>
        </arg>
        <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic" options="triggering-logic" group="Properties">
          <help short="Describes automation rule triggering logic."/>
          <arg nullable="True" type="array<object>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions" options="conditions">
            <help short="The conditions to evaluate to determine if the automation rule should be triggered on a given object."/>
            <item type="object">
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property" options="property">
                <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties" options="condition-properties">
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.operator" options="operator">
                    <enum>
                      <item name="Contains" value="&quot;Contains&quot;"/>
                      <item name="EndsWith" value="&quot;EndsWith&quot;"/>
                      <item name="Equals" value="&quot;Equals&quot;"/>
                      <item name="NotContains" value="&quot;NotContains&quot;"/>
                      <item name="NotEndsWith" value="&quot;NotEndsWith&quot;"/>
                      <item name="NotEquals" value="&quot;NotEquals&quot;"/>
                      <item name="NotStartsWith" value="&quot;NotStartsWith&quot;"/>
                      <item name="StartsWith" value="&quot;StartsWith&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyName" options="property-name">
                    <help short="The property to evaluate in an automation rule property condition."/>
                    <enum>
                      <item name="AccountAadTenantId" value="&quot;AccountAadTenantId&quot;"/>
                      <item name="AccountAadUserId" value="&quot;AccountAadUserId&quot;"/>
                      <item name="AccountNTDomain" value="&quot;AccountNTDomain&quot;"/>
                      <item name="AccountName" value="&quot;AccountName&quot;"/>
                      <item name="AccountObjectGuid" value="&quot;AccountObjectGuid&quot;"/>
                      <item name="AccountPUID" value="&quot;AccountPUID&quot;"/>
                      <item name="AccountSid" value="&quot;AccountSid&quot;"/>
                      <item name="AccountUPNSuffix" value="&quot;AccountUPNSuffix&quot;"/>
                      <item name="AlertProductNames" value="&quot;AlertProductNames&quot;"/>
                      <item name="AzureResourceResourceId" value="&quot;AzureResourceResourceId&quot;"/>
                      <item name="AzureResourceSubscriptionId" value="&quot;AzureResourceSubscriptionId&quot;"/>
                      <item name="CloudApplicationAppId" value="&quot;CloudApplicationAppId&quot;"/>
                      <item name="CloudApplicationAppName" value="&quot;CloudApplicationAppName&quot;"/>
                      <item name="DNSDomainName" value="&quot;DNSDomainName&quot;"/>
                      <item name="FileDirectory" value="&quot;FileDirectory&quot;"/>
                      <item name="FileHashValue" value="&quot;FileHashValue&quot;"/>
                      <item name="FileName" value="&quot;FileName&quot;"/>
                      <item name="HostAzureID" value="&quot;HostAzureID&quot;"/>
                      <item name="HostNTDomain" value="&quot;HostNTDomain&quot;"/>
                      <item name="HostName" value="&quot;HostName&quot;"/>
                      <item name="HostNetBiosName" value="&quot;HostNetBiosName&quot;"/>
                      <item name="HostOSVersion" value="&quot;HostOSVersion&quot;"/>
                      <item name="IPAddress" value="&quot;IPAddress&quot;"/>
                      <item name="IncidentDescription" value="&quot;IncidentDescription&quot;"/>
                      <item name="IncidentLabel" value="&quot;IncidentLabel&quot;"/>
                      <item name="IncidentProviderName" value="&quot;IncidentProviderName&quot;"/>
                      <item name="IncidentRelatedAnalyticRuleIds" value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                      <item name="IncidentSeverity" value="&quot;IncidentSeverity&quot;"/>
                      <item name="IncidentStatus" value="&quot;IncidentStatus&quot;"/>
                      <item name="IncidentTactics" value="&quot;IncidentTactics&quot;"/>
                      <item name="IncidentTitle" value="&quot;IncidentTitle&quot;"/>
                      <item name="IoTDeviceId" value="&quot;IoTDeviceId&quot;"/>
                      <item name="IoTDeviceModel" value="&quot;IoTDeviceModel&quot;"/>
                      <item name="IoTDeviceName" value="&quot;IoTDeviceName&quot;"/>
                      <item name="IoTDeviceOperatingSystem" value="&quot;IoTDeviceOperatingSystem&quot;"/>
                      <item name="IoTDeviceType" value="&quot;IoTDeviceType&quot;"/>
                      <item name="IoTDeviceVendor" value="&quot;IoTDeviceVendor&quot;"/>
                      <item name="MailMessageDeliveryAction" value="&quot;MailMessageDeliveryAction&quot;"/>
                      <item name="MailMessageDeliveryLocation" value="&quot;MailMessageDeliveryLocation&quot;"/>
                      <item name="MailMessageP1Sender" value="&quot;MailMessageP1Sender&quot;"/>
                      <item name="MailMessageP2Sender" value="&quot;MailMessageP2Sender&quot;"/>
                      <item name="MailMessageRecipient" value="&quot;MailMessageRecipient&quot;"/>
                      <item name="MailMessageSenderIP" value="&quot;MailMessageSenderIP&quot;"/>
                      <item name="MailMessageSubject" value="&quot;MailMessageSubject&quot;"/>
                      <item name="MailboxDisplayName" value="&quot;MailboxDisplayName&quot;"/>
                      <item name="MailboxPrimaryAddress" value="&quot;MailboxPrimaryAddress&quot;"/>
                      <item name="MailboxUPN" value="&quot;MailboxUPN&quot;"/>
                      <item name="MalwareCategory" value="&quot;MalwareCategory&quot;"/>
                      <item name="MalwareName" value="&quot;MalwareName&quot;"/>
                      <item name="ProcessCommandLine" value="&quot;ProcessCommandLine&quot;"/>
                      <item name="ProcessId" value="&quot;ProcessId&quot;"/>
                      <item name="RegistryKey" value="&quot;RegistryKey&quot;"/>
                      <item name="RegistryValueData" value="&quot;RegistryValueData&quot;"/>
                      <item name="Url" value="&quot;Url&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="array<string>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyValues" options="property-values">
                    <item type="string"/>
                  </arg>
                </arg>
              </arg>
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged" options="property-array-changed">
                <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties" options="condition-properties">
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.arrayType" options="array-type">
                    <enum>
                      <item name="Alerts" value="&quot;Alerts&quot;"/>
                      <item name="Comments" value="&quot;Comments&quot;"/>
                      <item name="Labels" value="&quot;Labels&quot;"/>
                      <item name="Tactics" value="&quot;Tactics&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.changeType" options="change-type">
                    <enum>
                      <item name="Added" value="&quot;Added&quot;"/>
                    </enum>
                  </arg>
                </arg>
              </arg>
              <arg type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged" options="property-changed">
                <arg nullable="True" type="object" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties" options="condition-properties">
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.changeType" options="change-type">
                    <enum>
                      <item name="ChangedFrom" value="&quot;ChangedFrom&quot;"/>
                      <item name="ChangedTo" value="&quot;ChangedTo&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.operator" options="operator">
                    <enum>
                      <item name="Contains" value="&quot;Contains&quot;"/>
                      <item name="EndsWith" value="&quot;EndsWith&quot;"/>
                      <item name="Equals" value="&quot;Equals&quot;"/>
                      <item name="NotContains" value="&quot;NotContains&quot;"/>
                      <item name="NotEndsWith" value="&quot;NotEndsWith&quot;"/>
                      <item name="NotEquals" value="&quot;NotEquals&quot;"/>
                      <item name="NotStartsWith" value="&quot;NotStartsWith&quot;"/>
                      <item name="StartsWith" value="&quot;StartsWith&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="string" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyName" options="property-name">
                    <enum>
                      <item name="IncidentOwner" value="&quot;IncidentOwner&quot;"/>
                      <item name="IncidentSeverity" value="&quot;IncidentSeverity&quot;"/>
                      <item name="IncidentStatus" value="&quot;IncidentStatus&quot;"/>
                    </enum>
                  </arg>
                  <arg nullable="True" type="array<string>" var="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyValues" options="property-values">
                    <item type="string"/>
                  </arg>
                </arg>
              </arg>
            </item>
          </arg>
          <arg nullable="True" type="dateTime" var="$automationRuleToUpsert.properties.triggeringLogic.expirationTimeUtc" options="expiration-time-utc">
            <help short="Determines when the automation rule should automatically expire and be disabled."/>
          </arg>
          <arg type="boolean" var="$automationRuleToUpsert.properties.triggeringLogic.isEnabled" options="is-enabled">
            <help short="Determines whether the automation rule is enabled or disabled."/>
          </arg>
          <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.triggersOn" options="triggers-on">
            <enum>
              <item name="Incidents" value="&quot;Incidents&quot;"/>
            </enum>
          </arg>
          <arg type="string" var="$automationRuleToUpsert.properties.triggeringLogic.triggersWhen" options="triggers-when">
            <enum>
              <item name="Created" value="&quot;Created&quot;"/>
              <item name="Updated" value="&quot;Updated&quot;"/>
            </enum>
          </arg>
        </arg>
      </argGroup>
      <operation operationId="AutomationRules_Get">
        <http path="/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/automationRules/{automationRuleId}">
          <request method="get">
            <path>
              <param type="string" name="automationRuleId" arg="$Path.automationRuleId" required="True"/>
              <param type="string" name="resourceGroupName" arg="$Path.resourceGroupName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
              <param type="string" name="subscriptionId" arg="$Path.subscriptionId" required="True">
                <format minLength="1"/>
              </param>
              <param type="string" name="workspaceName" arg="$Path.workspaceName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
            </path>
            <query>
              <const readOnly="True" const="True" type="string" name="api-version" required="True">
                <default value="&quot;2022-06-01-preview&quot;"/>
                <format minLength="1"/>
              </const>
            </query>
          </request>
          <response statusCode="200">
            <body>
              <json var="$Instance">
                <schema type="object" cls="AutomationRule_read">
                  <prop type="string" name="etag"/>
                  <prop readOnly="True" type="ResourceId" name="id">
                    <format template="/subscriptions/{}/resourceGroups/{}/providers/Microsoft.OperationalInsights/workspaces/{}/providers/Microsoft.SecurityInsights/automationRules/{}"/>
                  </prop>
                  <prop readOnly="True" type="string" name="name"/>
                  <prop type="object" name="properties" required="True" clientFlatten="True">
                    <prop type="array<object>" name="actions" required="True">
                      <item type="object">
                        <prop type="string" name="actionType" required="True">
                          <enum>
                            <item value="&quot;ModifyProperties&quot;"/>
                            <item value="&quot;RunPlaybook&quot;"/>
                          </enum>
                        </prop>
                        <prop type="integer32" name="order" required="True"/>
                        <discriminator property="actionType" value="ModifyProperties">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="classification">
                              <enum>
                                <item value="&quot;BenignPositive&quot;"/>
                                <item value="&quot;FalsePositive&quot;"/>
                                <item value="&quot;TruePositive&quot;"/>
                                <item value="&quot;Undetermined&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="classificationComment"/>
                            <prop type="string" name="classificationReason">
                              <enum>
                                <item value="&quot;InaccurateData&quot;"/>
                                <item value="&quot;IncorrectAlertLogic&quot;"/>
                                <item value="&quot;SuspiciousActivity&quot;"/>
                                <item value="&quot;SuspiciousButExpected&quot;"/>
                              </enum>
                            </prop>
                            <prop type="array<object>" name="labels">
                              <item type="object">
                                <prop type="string" name="labelName" required="True"/>
                                <prop readOnly="True" type="string" name="labelType">
                                  <enum>
                                    <item value="&quot;AutoAssigned&quot;"/>
                                    <item value="&quot;User&quot;"/>
                                  </enum>
                                </prop>
                              </item>
                            </prop>
                            <prop type="object" name="owner">
                              <prop type="string" name="assignedTo"/>
                              <prop type="string" name="email"/>
                              <prop type="uuid" name="objectId"/>
                              <prop type="string" name="ownerType">
                                <enum>
                                  <item value="&quot;Group&quot;"/>
                                  <item value="&quot;Unknown&quot;"/>
                                  <item value="&quot;User&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="userPrincipalName"/>
                            </prop>
                            <prop type="string" name="severity">
                              <enum>
                                <item value="&quot;High&quot;"/>
                                <item value="&quot;Informational&quot;"/>
                                <item value="&quot;Low&quot;"/>
                                <item value="&quot;Medium&quot;"/>
                              </enum>
                            </prop>
                            <prop type="string" name="status">
                              <enum>
                                <item value="&quot;Active&quot;"/>
                                <item value="&quot;Closed&quot;"/>
                                <item value="&quot;New&quot;"/>
                              </enum>
                            </prop>
                          </prop>
                        </discriminator>
                        <discriminator property="actionType" value="RunPlaybook">
                          <prop type="object" name="actionConfiguration">
                            <prop type="string" name="logicAppResourceId"/>
                            <prop type="uuid" name="tenantId"/>
                          </prop>
                        </discriminator>
                      </item>
                    </prop>
                    <prop readOnly="True" type="@ClientInfo_read" name="createdBy"/>
                    <prop readOnly="True" type="dateTime" name="createdTimeUtc"/>
                    <prop type="string" name="displayName" required="True">
                      <format maxLength="500"/>
                    </prop>
                    <prop readOnly="True" type="object" name="lastModifiedBy" cls="ClientInfo_read">
                      <prop readOnly="True" type="string" name="email"/>
                      <prop readOnly="True" type="string" name="name"/>
                      <prop readOnly="True" type="uuid" name="objectId"/>
                      <prop readOnly="True" type="string" name="userPrincipalName"/>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedTimeUtc"/>
                    <prop type="integer32" name="order" required="True">
                      <format maximum="1000" minimum="1"/>
                    </prop>
                    <prop type="object" name="triggeringLogic" required="True">
                      <prop type="array<object>" name="conditions">
                        <item type="object">
                          <prop type="string" name="conditionType" required="True">
                            <enum>
                              <item value="&quot;Property&quot;"/>
                              <item value="&quot;PropertyArrayChanged&quot;"/>
                              <item value="&quot;PropertyChanged&quot;"/>
                            </enum>
                          </prop>
                          <discriminator property="conditionType" value="Property">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;AccountAadTenantId&quot;"/>
                                  <item value="&quot;AccountAadUserId&quot;"/>
                                  <item value="&quot;AccountNTDomain&quot;"/>
                                  <item value="&quot;AccountName&quot;"/>
                                  <item value="&quot;AccountObjectGuid&quot;"/>
                                  <item value="&quot;AccountPUID&quot;"/>
                                  <item value="&quot;AccountSid&quot;"/>
                                  <item value="&quot;AccountUPNSuffix&quot;"/>
                                  <item value="&quot;AlertProductNames&quot;"/>
                                  <item value="&quot;AzureResourceResourceId&quot;"/>
                                  <item value="&quot;AzureResourceSubscriptionId&quot;"/>
                                  <item value="&quot;CloudApplicationAppId&quot;"/>
                                  <item value="&quot;CloudApplicationAppName&quot;"/>
                                  <item value="&quot;DNSDomainName&quot;"/>
                                  <item value="&quot;FileDirectory&quot;"/>
                                  <item value="&quot;FileHashValue&quot;"/>
                                  <item value="&quot;FileName&quot;"/>
                                  <item value="&quot;HostAzureID&quot;"/>
                                  <item value="&quot;HostNTDomain&quot;"/>
                                  <item value="&quot;HostName&quot;"/>
                                  <item value="&quot;HostNetBiosName&quot;"/>
                                  <item value="&quot;HostOSVersion&quot;"/>
                                  <item value="&quot;IPAddress&quot;"/>
                                  <item value="&quot;IncidentDescription&quot;"/>
                                  <item value="&quot;IncidentLabel&quot;"/>
                                  <item value="&quot;IncidentProviderName&quot;"/>
                                  <item value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                  <item value="&quot;IncidentTactics&quot;"/>
                                  <item value="&quot;IncidentTitle&quot;"/>
                                  <item value="&quot;IoTDeviceId&quot;"/>
                                  <item value="&quot;IoTDeviceModel&quot;"/>
                                  <item value="&quot;IoTDeviceName&quot;"/>
                                  <item value="&quot;IoTDeviceOperatingSystem&quot;"/>
                                  <item value="&quot;IoTDeviceType&quot;"/>
                                  <item value="&quot;IoTDeviceVendor&quot;"/>
                                  <item value="&quot;MailMessageDeliveryAction&quot;"/>
                                  <item value="&quot;MailMessageDeliveryLocation&quot;"/>
                                  <item value="&quot;MailMessageP1Sender&quot;"/>
                                  <item value="&quot;MailMessageP2Sender&quot;"/>
                                  <item value="&quot;MailMessageRecipient&quot;"/>
                                  <item value="&quot;MailMessageSenderIP&quot;"/>
                                  <item value="&quot;MailMessageSubject&quot;"/>
                                  <item value="&quot;MailboxDisplayName&quot;"/>
                                  <item value="&quot;MailboxPrimaryAddress&quot;"/>
                                  <item value="&quot;MailboxUPN&quot;"/>
                                  <item value="&quot;MalwareCategory&quot;"/>
                                  <item value="&quot;MalwareName&quot;"/>
                                  <item value="&quot;ProcessCommandLine&quot;"/>
                                  <item value="&quot;ProcessId&quot;"/>
                                  <item value="&quot;RegistryKey&quot;"/>
                                  <item value="&quot;RegistryValueData&quot;"/>
                                  <item value="&quot;Url&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyArrayChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="arrayType">
                                <enum>
                                  <item value="&quot;Alerts&quot;"/>
                                  <item value="&quot;Comments&quot;"/>
                                  <item value="&quot;Labels&quot;"/>
                                  <item value="&quot;Tactics&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;Added&quot;"/>
                                </enum>
                              </prop>
                            </prop>
                          </discriminator>
                          <discriminator property="conditionType" value="PropertyChanged">
                            <prop type="object" name="conditionProperties">
                              <prop type="string" name="changeType">
                                <enum>
                                  <item value="&quot;ChangedFrom&quot;"/>
                                  <item value="&quot;ChangedTo&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="operator">
                                <enum>
                                  <item value="&quot;Contains&quot;"/>
                                  <item value="&quot;EndsWith&quot;"/>
                                  <item value="&quot;Equals&quot;"/>
                                  <item value="&quot;NotContains&quot;"/>
                                  <item value="&quot;NotEndsWith&quot;"/>
                                  <item value="&quot;NotEquals&quot;"/>
                                  <item value="&quot;NotStartsWith&quot;"/>
                                  <item value="&quot;StartsWith&quot;"/>
                                </enum>
                              </prop>
                              <prop type="string" name="propertyName">
                                <enum>
                                  <item value="&quot;IncidentOwner&quot;"/>
                                  <item value="&quot;IncidentSeverity&quot;"/>
                                  <item value="&quot;IncidentStatus&quot;"/>
                                </enum>
                              </prop>
                              <prop type="array<string>" name="propertyValues">
                                <item type="string"/>
                              </prop>
                            </prop>
                          </discriminator>
                        </item>
                      </prop>
                      <prop type="dateTime" name="expirationTimeUtc"/>
                      <prop type="boolean" name="isEnabled" required="True"/>
                      <prop type="string" name="triggersOn" required="True">
                        <enum>
                          <item value="&quot;Incidents&quot;"/>
                        </enum>
                      </prop>
                      <prop type="string" name="triggersWhen" required="True">
                        <enum>
                          <item value="&quot;Created&quot;"/>
                          <item value="&quot;Updated&quot;"/>
                        </enum>
                      </prop>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="object" name="systemData">
                    <prop readOnly="True" type="dateTime" name="createdAt"/>
                    <prop readOnly="True" type="string" name="createdBy"/>
                    <prop readOnly="True" type="string" name="createdByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                    <prop readOnly="True" type="dateTime" name="lastModifiedAt"/>
                    <prop readOnly="True" type="string" name="lastModifiedBy"/>
                    <prop readOnly="True" type="string" name="lastModifiedByType">
                      <enum>
                        <item value="&quot;Application&quot;"/>
                        <item value="&quot;Key&quot;"/>
                        <item value="&quot;ManagedIdentity&quot;"/>
                        <item value="&quot;User&quot;"/>
                      </enum>
                    </prop>
                  </prop>
                  <prop readOnly="True" type="string" name="type"/>
                </schema>
              </json>
            </body>
          </response>
          <response isError="True">
            <body>
              <json>
                <schema type="@ODataV4Format"/>
              </json>
            </body>
          </response>
        </http>
      </operation>
      <operation>
        <instanceUpdate instance="$Instance">
          <json>
            <schema type="object" name="automationRuleToUpsert" clientFlatten="True">
              <prop type="string" name="etag" arg="$automationRuleToUpsert.etag"/>
              <prop type="object" name="properties" required="True" clientFlatten="True">
                <prop type="array<object>" name="actions" arg="$automationRuleToUpsert.properties.actions" required="True">
                  <item type="object">
                    <prop type="string" name="actionType" required="True">
                      <enum>
                        <item arg="$automationRuleToUpsert.properties.actions[].ModifyProperties" value="&quot;ModifyProperties&quot;"/>
                        <item arg="$automationRuleToUpsert.properties.actions[].RunPlaybook" value="&quot;RunPlaybook&quot;"/>
                      </enum>
                    </prop>
                    <prop type="integer32" name="order" arg="$automationRuleToUpsert.properties.actions[].order" required="True"/>
                    <discriminator property="actionType" value="ModifyProperties">
                      <prop type="object" name="actionConfiguration" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration">
                        <prop type="string" name="classification" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classification">
                          <enum>
                            <item value="&quot;BenignPositive&quot;"/>
                            <item value="&quot;FalsePositive&quot;"/>
                            <item value="&quot;TruePositive&quot;"/>
                            <item value="&quot;Undetermined&quot;"/>
                          </enum>
                        </prop>
                        <prop type="string" name="classificationComment" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationComment"/>
                        <prop type="string" name="classificationReason" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.classificationReason">
                          <enum>
                            <item value="&quot;InaccurateData&quot;"/>
                            <item value="&quot;IncorrectAlertLogic&quot;"/>
                            <item value="&quot;SuspiciousActivity&quot;"/>
                            <item value="&quot;SuspiciousButExpected&quot;"/>
                          </enum>
                        </prop>
                        <prop type="array<object>" name="labels" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels">
                          <item type="object">
                            <prop type="string" name="labelName" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.labels[].labelName" required="True"/>
                          </item>
                        </prop>
                        <prop type="object" name="owner" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner">
                          <prop type="string" name="assignedTo" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.assignedTo"/>
                          <prop type="string" name="email" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.email"/>
                          <prop type="uuid" name="objectId" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.objectId"/>
                          <prop type="string" name="ownerType" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.ownerType">
                            <enum>
                              <item value="&quot;Group&quot;"/>
                              <item value="&quot;Unknown&quot;"/>
                              <item value="&quot;User&quot;"/>
                            </enum>
                          </prop>
                          <prop type="string" name="userPrincipalName" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.owner.userPrincipalName"/>
                        </prop>
                        <prop type="string" name="severity" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.severity">
                          <enum>
                            <item value="&quot;High&quot;"/>
                            <item value="&quot;Informational&quot;"/>
                            <item value="&quot;Low&quot;"/>
                            <item value="&quot;Medium&quot;"/>
                          </enum>
                        </prop>
                        <prop type="string" name="status" arg="$automationRuleToUpsert.properties.actions[].ModifyProperties.actionConfiguration.status">
                          <enum>
                            <item value="&quot;Active&quot;"/>
                            <item value="&quot;Closed&quot;"/>
                            <item value="&quot;New&quot;"/>
                          </enum>
                        </prop>
                      </prop>
                    </discriminator>
                    <discriminator property="actionType" value="RunPlaybook">
                      <prop type="object" name="actionConfiguration" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration">
                        <prop type="string" name="logicAppResourceId" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.logicAppResourceId"/>
                        <prop type="uuid" name="tenantId" arg="$automationRuleToUpsert.properties.actions[].RunPlaybook.actionConfiguration.tenantId"/>
                      </prop>
                    </discriminator>
                  </item>
                </prop>
                <prop type="string" name="displayName" arg="$automationRuleToUpsert.properties.displayName" required="True">
                  <format maxLength="500"/>
                </prop>
                <prop type="integer32" name="order" arg="$automationRuleToUpsert.properties.order" required="True">
                  <format maximum="1000" minimum="1"/>
                </prop>
                <prop type="object" name="triggeringLogic" arg="$automationRuleToUpsert.properties.triggeringLogic" required="True">
                  <prop type="array<object>" name="conditions" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions">
                    <item type="object">
                      <prop type="string" name="conditionType" required="True">
                        <enum>
                          <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property" value="&quot;Property&quot;"/>
                          <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged" value="&quot;PropertyArrayChanged&quot;"/>
                          <item arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged" value="&quot;PropertyChanged&quot;"/>
                        </enum>
                      </prop>
                      <discriminator property="conditionType" value="Property">
                        <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties">
                          <prop type="string" name="operator" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.operator">
                            <enum>
                              <item value="&quot;Contains&quot;"/>
                              <item value="&quot;EndsWith&quot;"/>
                              <item value="&quot;Equals&quot;"/>
                              <item value="&quot;NotContains&quot;"/>
                              <item value="&quot;NotEndsWith&quot;"/>
                              <item value="&quot;NotEquals&quot;"/>
                              <item value="&quot;NotStartsWith&quot;"/>
                              <item value="&quot;StartsWith&quot;"/>
                            </enum>
                          </prop>
                          <prop type="string" name="propertyName" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyName">
                            <enum>
                              <item value="&quot;AccountAadTenantId&quot;"/>
                              <item value="&quot;AccountAadUserId&quot;"/>
                              <item value="&quot;AccountNTDomain&quot;"/>
                              <item value="&quot;AccountName&quot;"/>
                              <item value="&quot;AccountObjectGuid&quot;"/>
                              <item value="&quot;AccountPUID&quot;"/>
                              <item value="&quot;AccountSid&quot;"/>
                              <item value="&quot;AccountUPNSuffix&quot;"/>
                              <item value="&quot;AlertProductNames&quot;"/>
                              <item value="&quot;AzureResourceResourceId&quot;"/>
                              <item value="&quot;AzureResourceSubscriptionId&quot;"/>
                              <item value="&quot;CloudApplicationAppId&quot;"/>
                              <item value="&quot;CloudApplicationAppName&quot;"/>
                              <item value="&quot;DNSDomainName&quot;"/>
                              <item value="&quot;FileDirectory&quot;"/>
                              <item value="&quot;FileHashValue&quot;"/>
                              <item value="&quot;FileName&quot;"/>
                              <item value="&quot;HostAzureID&quot;"/>
                              <item value="&quot;HostNTDomain&quot;"/>
                              <item value="&quot;HostName&quot;"/>
                              <item value="&quot;HostNetBiosName&quot;"/>
                              <item value="&quot;HostOSVersion&quot;"/>
                              <item value="&quot;IPAddress&quot;"/>
                              <item value="&quot;IncidentDescription&quot;"/>
                              <item value="&quot;IncidentLabel&quot;"/>
                              <item value="&quot;IncidentProviderName&quot;"/>
                              <item value="&quot;IncidentRelatedAnalyticRuleIds&quot;"/>
                              <item value="&quot;IncidentSeverity&quot;"/>
                              <item value="&quot;IncidentStatus&quot;"/>
                              <item value="&quot;IncidentTactics&quot;"/>
                              <item value="&quot;IncidentTitle&quot;"/>
                              <item value="&quot;IoTDeviceId&quot;"/>
                              <item value="&quot;IoTDeviceModel&quot;"/>
                              <item value="&quot;IoTDeviceName&quot;"/>
                              <item value="&quot;IoTDeviceOperatingSystem&quot;"/>
                              <item value="&quot;IoTDeviceType&quot;"/>
                              <item value="&quot;IoTDeviceVendor&quot;"/>
                              <item value="&quot;MailMessageDeliveryAction&quot;"/>
                              <item value="&quot;MailMessageDeliveryLocation&quot;"/>
                              <item value="&quot;MailMessageP1Sender&quot;"/>
                              <item value="&quot;MailMessageP2Sender&quot;"/>
                              <item value="&quot;MailMessageRecipient&quot;"/>
                              <item value="&quot;MailMessageSenderIP&quot;"/>
                              <item value="&quot;MailMessageSubject&quot;"/>
                              <item value="&quot;MailboxDisplayName&quot;"/>
                              <item value="&quot;MailboxPrimaryAddress&quot;"/>
                              <item value="&quot;MailboxUPN&quot;"/>
                              <item value="&quot;MalwareCategory&quot;"/>
                              <item value="&quot;MalwareName&quot;"/>
                              <item value="&quot;ProcessCommandLine&quot;"/>
                              <item value="&quot;ProcessId&quot;"/>
                              <item value="&quot;RegistryKey&quot;"/>
                              <item value="&quot;RegistryValueData&quot;"/>
                              <item value="&quot;Url&quot;"/>
                            </enum>
                          </prop>
                          <prop type="array<string>" name="propertyValues" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].Property.conditionProperties.propertyValues">
                            <item type="string"/>
                          </prop>
                        </prop>
                      </discriminator>
                      <discriminator property="conditionType" value="PropertyArrayChanged">
                        <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties">
                          <prop type="string" name="arrayType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.arrayType">
                            <enum>
                              <item value="&quot;Alerts&quot;"/>
                              <item value="&quot;Comments&quot;"/>
                              <item value="&quot;Labels&quot;"/>
                              <item value="&quot;Tactics&quot;"/>
                            </enum>
                          </prop>
                          <prop type="string" name="changeType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyArrayChanged.conditionProperties.changeType">
                            <enum>
                              <item value="&quot;Added&quot;"/>
                            </enum>
                          </prop>
                        </prop>
                      </discriminator>
                      <discriminator property="conditionType" value="PropertyChanged">
                        <prop type="object" name="conditionProperties" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties">
                          <prop type="string" name="changeType" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.changeType">
                            <enum>
                              <item value="&quot;ChangedFrom&quot;"/>
                              <item value="&quot;ChangedTo&quot;"/>
                            </enum>
                          </prop>
                          <prop type="string" name="operator" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.operator">
                            <enum>
                              <item value="&quot;Contains&quot;"/>
                              <item value="&quot;EndsWith&quot;"/>
                              <item value="&quot;Equals&quot;"/>
                              <item value="&quot;NotContains&quot;"/>
                              <item value="&quot;NotEndsWith&quot;"/>
                              <item value="&quot;NotEquals&quot;"/>
                              <item value="&quot;NotStartsWith&quot;"/>
                              <item value="&quot;StartsWith&quot;"/>
                            </enum>
                          </prop>
                          <prop type="string" name="propertyName" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyName">
                            <enum>
                              <item value="&quot;IncidentOwner&quot;"/>
                              <item value="&quot;IncidentSeverity&quot;"/>
                              <item value="&quot;IncidentStatus&quot;"/>
                            </enum>
                          </prop>
                          <prop type="array<string>" name="propertyValues" arg="$automationRuleToUpsert.properties.triggeringLogic.conditions[].PropertyChanged.conditionProperties.propertyValues">
                            <item type="string"/>
                          </prop>
                        </prop>
                      </discriminator>
                    </item>
                  </prop>
                  <prop type="dateTime" name="expirationTimeUtc" arg="$automationRuleToUpsert.properties.triggeringLogic.expirationTimeUtc"/>
                  <prop type="boolean" name="isEnabled" arg="$automationRuleToUpsert.properties.triggeringLogic.isEnabled" required="True"/>
                  <prop type="string" name="triggersOn" arg="$automationRuleToUpsert.properties.triggeringLogic.triggersOn" required="True">
                    <enum>
                      <item value="&quot;Incidents&quot;"/>
                    </enum>
                  </prop>
                  <prop type="string" name="triggersWhen" arg="$automationRuleToUpsert.properties.triggeringLogic.triggersWhen" required="True">
                    <enum>
                      <item value="&quot;Created&quot;"/>
                      <item value="&quot;Updated&quot;"/>
                    </enum>
                  </prop>
                </prop>
              </prop>
            </schema>
          </json>
        </instanceUpdate>
      </operation>
      <operation operationId="AutomationRules_CreateOrUpdate">
        <http path="/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/automationRules/{automationRuleId}">
          <request method="put">
            <path>
              <param type="string" name="automationRuleId" arg="$Path.automationRuleId" required="True"/>
              <param type="string" name="resourceGroupName" arg="$Path.resourceGroupName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
              <param type="string" name="subscriptionId" arg="$Path.subscriptionId" required="True">
                <format minLength="1"/>
              </param>
              <param type="string" name="workspaceName" arg="$Path.workspaceName" required="True">
                <format maxLength="90" minLength="1"/>
              </param>
            </path>
            <query>
              <const readOnly="True" const="True" type="string" name="api-version" required="True">
                <default value="&quot;2022-06-01-preview&quot;"/>
                <format minLength="1"/>
              </const>
            </query>
            <body>
              <json ref="$Instance"/>
            </body>
          </request>
          <response statusCode="200 201">
            <body>
              <json var="$Instance">
                <schema type="@AutomationRule_read"/>
              </json>
            </body>
          </response>
          <response isError="True">
            <body>
              <json>
                <schema type="@ODataV4Format"/>
              </json>
            </body>
          </response>
        </http>
      </operation>
      <output type="object" ref="$Instance" clientFlatten="True"/>
    </command>
  </commandGroup>
</CodeGen>
